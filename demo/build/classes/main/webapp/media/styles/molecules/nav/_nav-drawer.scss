$nav-drawer-background-opacity: 0.9;
$nav-drawer-background-start-color: rgba(#111111, $nav-drawer-background-opacity * 0.5);
$nav-drawer-background-middle-color: rgba(#111111, $nav-drawer-background-opacity * 0.8);
$nav-drawer-background-end-color: rgba(75, 82, 84, $nav-drawer-background-opacity);

@mixin navdrawer($zIndex) {
	box-sizing: border-box;
	position: fixed;
	top: 0;
	z-index: $zIndex;
	transition: margin-left 0.3s ease-out;
	-webkit-font-smoothing: antialiased;
}

@mixin main-nav-toggle($arrow) {
	float: right;
	padding-right: 1em;
	cursor: pointer;
	@include icon($arrow);
}

$nav-light-map: (nav-width: 14.375em);

#nav-drawer {
	html:not(.ie9):not(.ie8):not(.ie7):not(.ie6) & {
		@include transform(translateZ(0));
	}
	// Quarks
	ul, ol {
		padding: 0;
		margin: 0;
		list-style-type: none;
		ul, ol {
			list-style-type: none;
		}
	}
	&.open {
		margin-left: 0;
		#nav-drawer--slider {
			right: -1em;
		}
	}
}

.nav-drawer {
	&--dark {
		font-size: 1rem;
		line-height: 1;
		height: 100%;
		width: 11rem;
		margin-left: -11rem;
		margin-top: $site-header-height;
		padding-bottom: $site-header-height;
		@include navdrawer($nav-index);
		color: $light-grey;
		html:not(.ie9):not(.ie8):not(.ie7):not(.ie6) & {
			background: -moz-linear-gradient(99.79% 49.85% 180deg, $nav-drawer-background-start-color 0%, $nav-drawer-background-middle-color 6.5%, $nav-drawer-background-end-color 100%);
			background: -webkit-linear-gradient(180deg, $nav-drawer-background-start-color 0%, $nav-drawer-background-middle-color 6.5%, $nav-drawer-background-end-color 100%);
			background: -webkit-gradient(linear, 99.79% 49.85%, 0.2% 49.85%, color-stop(0, $nav-drawer-background-start-color), color-stop(0.065, $nav-drawer-background-middle-color), color-stop(1, $nav-drawer-background-end-color));
			background: -o-linear-gradient(180deg, $nav-drawer-background-start-color 0%, $nav-drawer-background-middle-color 6.5%, $nav-drawer-background-end-color 100%);
			background: -ms-linear-gradient(180deg, $nav-drawer-background-start-color 0%, $nav-drawer-background-middle-color 6.5%, $nav-drawer-background-end-color 100%);
			background: linear-gradient(-90deg, $nav-drawer-background-start-color 0%, $nav-drawer-background-middle-color 6.5%, $nav-drawer-background-end-color 100%);
			-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr='#000000',endColorstr='#4B5254' ,GradientType=0)";
		}
		#main-nav {
			font-size: 0.8em;
			overflow: auto;
			height: 100%;
			a {
				text-decoration: none;
			}
			.main-nav {
				&--title, &--item a {
					padding: 0.5em 0.2em;
					color: inherit;
					&:hover {
						color: $white;
						background-color: $orange;
					}
				}
				&--section {
					margin: 2em 0;
					padding: 0 0.5em;
					overflow: hidden;
					&:first-child {
						margin-top: 1.4em;
					}
					&.active {
						color: $white;
					}
					.fk-button-nps {
						display: block;
						text-align: center;
					}
				}
				&--subnav {
					clear: both;
					padding: 0.5em 0.5em 0;
				}
				&--icon {
					font-size: 1.5em;
					float: left;
					margin: 0 0.5em;
				}
				&--title {
					display: block;
					border-radius: 2px;
					background-clip: padding-box;
					&:hover {
						[class^="icon-"], [class*=" icon-"] {
							fill: $white;
						}
					}
					a {
						color: inherit;
					}
				}
				&--item {
					&.active {
						a {
							color: $orange;
							&:hover {
								color: $white;
								background-color: $orange;
							}
						}
						.wm-icon-right-arrow {
							display: block;
						}
					}
					&.-subitem a {
						padding-left: 3.5em;
					}
					a {
						border-radius: 2px;
						background-clip: padding-box;
						padding-left: 2.5em;
						display: block;
						color: inherit;
						&:hover {
							color: $white;
							background-color: $orange;
						}
					}
					.wm-icon-right-arrow {
						display: none;
						height: 1em;
						width: 1em;
						float: left;
						fill: $white;
						margin-top: 5px;
						margin-left: 1em;
						@include transform(translateZ(-1px));
					}
				}
			}
		}
		#nav-drawer {
			&--slider {
				font-size: 1em;
				position: absolute;
				right: -3.15em;
				top: 2em;
				transition: right 0.3s ease-out;
				background-color: $orange;
				width: 1.85em;
				height: 1.85em;
				padding: 0.3em;
				box-sizing: border-box;
				@include circle;
				background-clip: padding-box;
				border: 2px solid $white;
				cursor: pointer;
				.slider-button {
					transition: 0.3s;
					cursor: pointer;
					user-select: none;
					line-height: 1;
					padding-top: 0.45em;
					&:active {
						transition: 0;
					}
					& {
						top: 0;
						width: calc(1em / 1.8);
					}
					.lines {
						display: block;
						width: 1em;
						height: calc(1em / 7);
						background: $white;
						border-radius: calc(1em / 14);
						transition: 0.3s;
						position: relative;
						&:before, &:after {
							display: block;
							width: 1em;
							height: calc(1em / 7);
							background: $white;
							border-radius: calc(1em / 14);
							transition: 0.3s;
							position: absolute;
							left: 0;
							content: '';
							@include transform-origin(calc(1em / 14) center);
						}
						&:before {
							top: 0.25em;
						}
						&:after {
							top: -0.25em;
						}
					}
				}
			}
		}
	}
	&--light {
		@include scaffolding;
		@include new-typography;
		@include navdrawer($nav-index - 2);
		font-size: 0.875rem !important;
		height: 100%;
		padding-bottom: $site-header-height;
		width: map-get($nav-light-map, nav-width);
		margin-left: (map-get($nav-light-map, nav-width) * -0.72);
		background: $white !important;
		margin-top: 3.125rem;
		&.open {
			color: $grey;
			.main-nav {
				&--title {
					padding: 1.5em 0em 0.5em 0.5em;
					.-home {
						&::after {
							display: none;
						}
						&::before {
							float: left;
						}
					}
				}
				&--inner-title {
					font-weight: 600;
					&::before {
						display: inline;
						font-size: 1em;
						margin: 0em 1em;
						float: left;
					}
				}
				&--section {
					cursor: pointer;
					margin: 0;
					min-height: 4em;
					line-height: 1;
					overflow: hidden;
					box-shadow: inset 0 1px 1px -1px $light-grey;
					&.-expanded {
						.main-nav {
							&--toggle {
								&::after {
									@include main-nav-toggle(up-arrow);
								}
							}
						}
					}
					.search {
						&--input {
							border-color: transparent;
							box-shadow: none;
							border-radius: 0;
							margin-bottom: 0;
							height: 3em;
							&:focus {
								background: $white;
							}
						}
						&--submit {
							visibility: hidden;
							top: 4px;
							right: 3em;
							border-radius: 0;
							&:after {
								content: 'Go';
								visibility: visible;
								transition: all 0.2s linear;
								position: absolute;
								padding: calc(0.5em - 2px);
								background-color: $blue;
								color: #ffffff;
								cursor: pointer;
							}
						}
					}
					.main-nav{
						&--toggle {
							&::after {
								@include main-nav-toggle(down-arrow);
							}
						}
					}
					&.active {
						.main-nav {
							&--subnav {
								display: block;
								a {
									padding: 0.75em 0.2em 0.75em 3.5em;
								}
							}
						}
					}
					.main-nav {
						&--subnav {
							display: none;
							.main-nav {
								&--item {
									box-shadow: none;
									line-height: 0.3;
									span {
										display: none;
									}
								}
							}
						}
					}
					&.-expanded {
						.main-nav {
							&--title {
								&.-home {
									&::after {
										display: none;
									}
								}
							}
						}
						.main-nav {
							&--subnav {
								display: block;
							}
						}
					}
				}
			}
		}
		&:not(.open) {
			color: $grey;
			.main-nav {
				&--inner-title {
					&::before {
						font-size: 1.25em;
						margin: -0.25em 1em 0;
						float: right;
					}
				}
				&--title {
					padding: 1.5em 0.2em;
					&.-active, &.active {
						background-color: $blue;
						color: $white;
					}
					&.-home {
						&:hover {
							color: $white;
						}
					}
				}
				&--section {
					line-height: 1;
					cursor: pointer;
					margin: 0;
					min-height: 4em;
					overflow: hidden;
					&.-home {
						&:hover {
							box-shadow: inset 0 -1px 1px -1px $light-grey;
						}
					}
					.main-nav {
						&--subnav {
							display: none;
							background-color: $white;
						}
					}
					&:hover {
						background-color: $blue;
						color: $white;
						box-shadow: inset 0 1px 1px -1px #cecece;
						.main-nav {
							&--subnav {
								display: block;
								position: absolute;
								width: 100%;
								left: map-get($nav-light-map, nav-width);
								margin-top: -4em !important;
								box-shadow: 0.85em 0.5em 1.5em -0.05em rgba(100, 107, 111, 0.35);
								span {
									padding: 1.35em 1.75em;
								}
								a {
									padding: 0.75em 1.75em;
								}
							}
						}
					}
					&.active {
						background-color: $blue;
						color: $white;
					}
				}
			}
		}
		.main-nav {
			&--item {
				color: $blue;
				&.active {
					background-color: rgba($blue, 0.50);
					color: $white;
					a {
						&:hover {
							background-color: $orange;
							color: $white;
						}
					}
				}
				span, a {
					text-decoration: none;
					background-clip: border-box;
					display: block;
					color: inherit;
				}
				span {
					color: $white;
					background-color: $blue;
					cursor: default;
					padding: 1.35em 1.75em;
					font-weight: 600;
				}
				a {
					padding: 0.75em 0.2em 0.75em 3.5em;
					&:hover {
						color: $white;
						background-color: $orange;
					}
				}
			}
			&--title {
				display: block;
				border-radius: 0px;
				a {
					color: inherit;
					text-decoration: none;
				}
				span {
					cursor: default;
				}
				.-home {
					&::before {
						display: inline;
						@include icon(house);
					}
				}
			}
			&--inner-title {
				&::before {
					font-size: 1.25em;
					margin: -0.25em 0.75em 0;
					float: left;
					cursor: pointer;
				}
				&.-search-inner-title {
					&::before {
						@include icon(search);
					}
				}
				&.-work-inner-title {
					&::before {
						@include icon(work);
					}
				}
				&.-market-inner-title {
					&::before {
						@include icon(users);
					}
				}
				&.-payments-inner-title {
					&::before {
						@include icon(payments);
					}
				}
				&.-profile-inner-title {
					&::before {
						@include icon(user);
					}
				}
				&.-reports-inner-title {
					&::before {
						@include icon(pie-chart);
					}
				}
			}
		}
		@media only screen and (min-width: 671px) {
			&.open {
				box-shadow: 0 0 0.5em 0 $off-white;
				&#nav-drawer {
					overflow: auto;
					#main-nav {
						margin-bottom: 7em;
						.main-nav {
							box-shadow: none;
							&--search {
								display: none;
							}
							&--title {
								.main-nav {
									&--toggle {
										display: none;
									}
								}
							}
							&--section {
								.main-nav {
									&--subnav {
										display: block;
									}
								}
							}
						}
					}
				}
			}
			&:not(.open) {
				.main-nav {
					&--search {
						display: none;
					}
				}
			}
		}
		@media only screen and (max-width: 670px) {
			width: 7.15rem;
			&.open {
				width: 100%;
				&.mobileNavWidth {
					width: 50%;
				}
				#main-nav {
					box-shadow: inset 0 -1px 1px -1px $light-grey;
					.-search-title {
						.search {
							&--input {
								border-color: transparent;
								border-radius: 0;
								margin-bottom: 0;
								background: $white;
							}
							&--submit {
								top: 0em;
								right: 1em;
								border-radius: 0;
								background-color: $blue;
							}
						}
						.main-nav--inner-title{
							&:first-child {
								&:before {
									margin: 0.5em 1em;
								}
							}
						}
					}
				}
			}
		}
	}
}